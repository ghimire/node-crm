
if(typeof(RGraph)=='undefined')RGraph={};if(typeof(RGraph.Drawing)=='undefined')RGraph.Drawing={};RGraph.Drawing.Marker1=function(id,x,y,radius,text)
{this.id=id;this.canvas=document.getElementById(id);this.context=this.canvas.getContext?this.canvas.getContext("2d"):null;this.colorsParsed=false;this.centerx=x;this.centery=y;this.radius=radius;this.text=text;this.canvas.__object__=this;this.type='drawing.marker1';this.isRGraph=true;this.uid=RGraph.CreateUID();this.canvas.uid=this.canvas.uid?this.canvas.uid:RGraph.CreateUID();RGraph.OldBrowserCompat(this.context);this.properties={'chart.strokestyle':'black','chart.fillstyle':'white','chart.linewidth':2,'chart.text.color':'black','chart.text.size':12,'chart.text.font':'Arial','chart.events.click':null,'chart.events.mousemove':null,'chart.shadow':true,'chart.shadow.color':'#aaa','chart.shadow.offsetx':0,'chart.shadow.offsety':0,'chart.shadow.blur':15,'chart.highlight.stroke':'transparent','chart.highlight.fill':'rgba(255,255,255,0.7)','chart.tooltips':null,'chart.tooltips.highlight':true,'chart.tooltips.event':'onclick','chart.align':'center'}
if(!this.canvas){alert('[DRAWING.MARKER1] No canvas support');return;}
this.$0={};this.coords=[];RGraph.Register(this);}
RGraph.Drawing.Marker1.prototype.Set=function(name,value)
{name=name.toLowerCase();if(name.substr(0,6)!='chart.'){name='chart.'+name;}
this.properties[name]=value;}
RGraph.Drawing.Marker1.prototype.Get=function(name)
{if(name.substr(0,6)!='chart.'){name='chart.'+name;}
return this.properties[name.toLowerCase()];}
RGraph.Drawing.Marker1.prototype.Draw=function()
{RGraph.FireCustomEvent(this,'onbeforedraw');var r=this.radius;if(this.properties['chart.align']=='left'){this.markerCenterx=this.centerx-r-r-3;this.markerCentery=this.centery-r-r-3;}else if(this.properties['chart.align']=='right'){this.markerCenterx=this.centerx+r+r+3;this.markerCentery=this.centery-r-r-3;}else{this.markerCenterx=this.centerx;this.markerCentery=this.centery-r-r-3;}
if(!this.colorsParsed){this.parseColors();this.colorsParsed=true;}
this.context.beginPath();if(this.properties['chart.shadow']){RGraph.SetShadow(this,this.properties['chart.shadow.color'],this.properties['chart.shadow.offsetx'],this.properties['chart.shadow.offsety'],this.properties['chart.shadow.blur']);}
this.context.lineWidth=this.properties['chart.linewidth'];this.context.strokeStyle=this.properties['chart.strokestyle'];this.context.fillStyle=this.properties['chart.fillstyle'];this.DrawMarker();this.context.stroke();this.context.fill();RGraph.NoShadow(this);this.context.fillStyle=this.properties['chart.text.color'];RGraph.Text(this.context,this.properties['chart.text.font'],this.properties['chart.text.size'],this.coords[0][0]-1,this.coords[0][1]-1,this.text,'center','center');RGraph.InstallEventListeners(this);RGraph.FireCustomEvent(this,'ondraw');}
RGraph.Drawing.Marker1.prototype.getObjectByXY=function(e)
{if(this.getShape(e)){return this;}}
RGraph.Drawing.Marker1.prototype.getShape=function(e)
{var mouseXY=RGraph.getMouseXY(e);var mouseX=mouseXY[0];var mouseY=mouseXY[1];this.context.beginPath();this.DrawMarker();if(this.context.isPointInPath(mouseXY[0],mouseXY[1])){return{0:this,1:this.coords[0][0],2:this.coords[0][1],3:this.coords[0][2],4:0,'object':this,'x':this.coords[0][0],'y':this.coords[0][1],'radius':this.coords[0][2],'index':0,'tooltip':this.properties['chart.tooltips']?this.properties['chart.tooltips'][0]:null};}
return null;}
RGraph.Drawing.Marker1.prototype.positionTooltip=function(obj,x,y,tooltip,idx)
{var canvasXY=RGraph.getCanvasXY(obj.canvas);var width=tooltip.offsetWidth;var height=tooltip.offsetHeight;tooltip.style.left=0;tooltip.style.top=canvasXY[1]+this.coords[0][1]-height-7-this.radius+'px';tooltip.style.overflow='';var img=new Image();img.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAFCAYAAACjKgd3AAAARUlEQVQYV2NkQAN79+797+RkhC4M5+/bd47B2dmZEVkBCgcmgcsgbAaA9GA1BCSBbhAuA/AagmwQPgMIGgIzCD0M0AMMAEFVIAa6UQgcAAAAAElFTkSuQmCC';img.style.position='absolute';img.id='__rgraph_tooltip_pointer__';img.style.top=(tooltip.offsetHeight-2)+'px';tooltip.appendChild(img);if((canvasXY[0]+obj.coords[0][0]+(obj.coords[0][2]/2)-(width/2))<10){tooltip.style.left=canvasXY[0]+this.markerCenterx-(width*0.1)+'px';img.style.left=((width*0.1)-8.5)+'px';}else if((canvasXY[0]+this.coords[0][0]+(this.coords[0][2]/2)+(width/2))>document.body.offsetWidth){tooltip.style.left=canvasXY[0]+this.markerCenterx-(width*0.9)+'px';img.style.left=((width*0.9)-8.5)+'px';}else{tooltip.style.left=(canvasXY[0]+this.markerCenterx-(width*0.5))+'px';img.style.left=((width*0.5)-8.5)+'px';}}
RGraph.Drawing.Marker1.prototype.Highlight=function(shape)
{this.context.beginPath();this.context.strokeStyle=this.properties['chart.highlight.stroke'];this.context.fillStyle=this.properties['chart.highlight.fill'];this.DrawMarker();this.context.closePath();this.context.stroke();this.context.fill();}
RGraph.Drawing.Marker1.prototype.DrawMarker=function()
{var r=this.radius;if(this.properties['chart.align']=='left'){var x=this.markerCenterx;var y=this.markerCentery;this.context.arc(x,y,r,HALFPI,TWOPI,false);if(RGraph.isOld()){this.context.moveTo(x+r+r,y+r+r);this.context.quadraticCurveTo(x+r,y+r,x+r+1,y);this.context.moveTo(x+r+r,y+r+r);}else{this.context.quadraticCurveTo(x+r,y+r,x+r+r,y+r+r);}
this.context.quadraticCurveTo(x+r,y+r,x,y+r+(RGraph.isOld()?1:0));}else if(this.properties['chart.align']=='right'){var x=this.markerCenterx;var y=this.markerCentery;this.context.arc(x,y,r,HALFPI,PI,true);if(RGraph.isOld()){this.context.moveTo(x-r-r,y+r+r);this.context.quadraticCurveTo(x-r,y+r,x-r-1,y);this.context.moveTo(x-r-r,y+r+r);}else{this.context.quadraticCurveTo(x-r,y+r,x-r-r,y+r+r);}
this.context.quadraticCurveTo(x-r,y+r,x,y+r+(RGraph.isOld()?1:0));}else{var x=this.markerCenterx;var y=this.markerCentery;this.context.arc(x,y,r,HALFPI/2,PI-(HALFPI/2),true);if(RGraph.isOld()){this.context.moveTo(x,y+r+r-2);this.context.quadraticCurveTo(x,y+r+(r/4),x-(Math.cos(HALFPI/2)*r),y+(Math.sin(HALFPI/2)*r));this.context.moveTo(x,y+r+r-2);}else{this.context.quadraticCurveTo(x,y+r+(r/4),x,y+r+r-2);}
this.context.quadraticCurveTo(x,y+r+(r/4),x+(Math.cos(HALFPI/2)*r),y+(Math.sin(HALFPI/2)*r));}
this.coords[0]=[x,y,r];}
RGraph.Drawing.Marker1.prototype.parseColors=function()
{this.properties['chart.fillstyle']=this.parseSingleColorForGradient(this.properties['chart.fillstyle']);this.properties['chart.strokestyle']=this.parseSingleColorForGradient(this.properties['chart.strokestyle']);this.properties['chart.highlight.stroke']=this.parseSingleColorForGradient(this.properties['chart.highlight.stroke']);this.properties['chart.highlight.fill']=this.parseSingleColorForGradient(this.properties['chart.highlight.fill']);this.properties['chart.text.color']=this.parseSingleColorForGradient(this.properties['chart.text.color']);}
RGraph.Drawing.Marker1.prototype.parseSingleColorForGradient=function(color)
{var canvas=this.canvas;var context=this.context;if(!color||typeof(color)!='string'){return color;}
if(color.match(/^gradient\((.*)\)$/i)){var parts=RegExp.$1.split(':');var grad=context.createRadialGradient(this.markerCenterx,this.markerCentery,0,this.markerCenterx,this.markerCentery,this.radius);var diff=1/(parts.length-1);grad.addColorStop(0,RGraph.trim(parts[0]));for(var j=1;j<parts.length;++j){grad.addColorStop(j*diff,RGraph.trim(parts[j]));}}
return grad?grad:color;}